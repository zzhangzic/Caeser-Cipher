.ORIG x3000

HI_1  .STRINGZ "Hello, welcome to my Caesar Cipher program"
HI_2 .STRINGZ "\nDo you want to(E)ncrypt or (D)ecryot ir E(X)IT?\n"
HI_3 .STRINGZ "\nWhat is the cipher(1-25) number?\n"
HI_4 .STRINGZ "What is the string(up to 200 characters?)\n"

NUMBER .FILL #0

LEA R0,HI_1
PUTS

AGAIN
AND R0,R0,0
ST R0,FLAG
ST R0,NUMBER
ST R0,COUNTER
LEA R0,HI_2
PUTS

GETC
PUTC

ADD R1,R0,#-8
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
BRz STOP

AND R1,R1,#0
ADD R1,R0,#-4
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
BRz DECRYPT

AND R1,R1,#0
ADD R1,R0,#-5
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
ADD R1,R1,#-16
BRz ENCRYPT
BRnp AGAIN

STOP
JSR STOP2

DECRYPT
AND R2,R2,#0
AND R3,R3,#0
ADD R2,R2,#1
ST R2,FLAG
AND R2,R2,#0
BR CASAR

ENCRYPT
AND R2,R2,#0
AND R3,R3,#0
ADD R2,R2,#-1
ST R2,FLAG
AND R2,R2,#0
BR CASAR

CASAR
AND R1,R1,#0
LEA R0,HI_3
PUTS

INPUTNUMBER
GETC
PUTC

AND R5,R5,#0
ADD R5,R5,#9
ADD R3,R0,#-10
BRz ENTERA

AND R3,R3,#0
AND R4,R4,#0

SAVE
LD R1,NUMBER
ADD R3,R3,R1
ADD R5,R5,#-1
BRp SAVE

ADD R4,R0,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R3,R3,R4
ST R3,NUMBER
BRnzp INPUTNUMBER

ENTERA
JSR RESETREGISTER
JSR LOADARRAY
LD R2,COUNTER
LEA R0,HI_4
PUTS

GETLETTER
GETC
PUTC

ADD R1,R0,#-10
BRz ENTERB

ADD R2,R2,#1
STR R0,R6,#0
ADD R6,R6,#2
AND R1,R1,#0
BR GETLETTER

ENTERB
ST R2,COUNTER
JSR LOADARRAY

ENTERC
LDR R3,R6,#0
ADD R4,R3,#-1
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRn SKIPA

AND R4,R4,#0
ADD R4,R3,#-10
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRnz CAPITAL
BR CHECKAZ

CAPITAL
AND R4,R4,#0
LD R5,FLAG
BRn CAPITALE

ADD R4,R3,#-13
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRp CAPITAL2

AND R5,R5,#0
AND R4,R4,#0
LD R5,NUMBER
ADD R4,R5,R3
BR SKIPB

CAPITAL2
AND R4,R4,#0
AND R5,R5,#0
LD R5,NUMBER
NOT R5,R5
ADD R5,R5,#1
ADD R4,R3,R5
BR SKIPB

CAPITALE
ADD R4,R3,#-13
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRnz CAPEA

AND R5,R5,#0
AND R4,R4,#0
LD R5,NUMBER
NOT R5,R5
ADD R5,R5,#1
ADD R4,R3,R5
BR SKIPB

CAPEA
AND R5,R5,#0
AND R4,R4,#0
LD R4, NUMBER
ADD R4,R3,R5
BR SKIPB

HI_5 .STRINGZ "Here is your string and the encrypted result:"

CHECKAZ
AND R4,R4,#0
ADD R4,R3,#-1
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRn SKIPA

AND R4,R4,#0
ADD R4,R3,#-10
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRnz LOW
BR SKIPA

LOW
AND R5,R5,#0
AND R4,R4,#0
LD R5,FLAG
BRn LOWE

ADD R4,R3,#-13
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRp LOWB

AND R5,R5,#0
AND R4,R4,#0
LD R5,NUMBER
ADD R4,R3,R5
BR SKIPB

LOWB
AND R4,R4,#0
AND R5,R5,#0
LD R5,NUMBER
NOT R5,R5
ADD R5,R5,#1
ADD R4,R3,R5
BR SKIPB

LOWE
ADD R4,R3,#-13
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
ADD R4,R4,#-16
BRnz LOWEB

AND R5,R5,#0
AND R4,R4,#0
LD R5,NUMBER
NOT R5,R5
ADD R5,R5,#1
ADD R4,R3,R5
BR SKIPB

FLAG .FILL #0
COUNTER .FILL #0

LOWEB
AND R5,R5,#0
AND R4,R4,#0
LD R5,NUMBER
ADD R4,R3,R5
BR SKIPB

SKIPA
STR R3,R6,#1
ADD R6,R6,#2
ADD R2,R2,#-1
BRp ENTERC

SKIPB
STR R4,R6,#1
ADD R6,R6,#2
ADD R2,R2,#-1
BRp ENTERC


JSR RESETREGISTER
JSR CHECKFLAG
BRp FINALD
JSR FINALE

FINALD
LEA R0,HI_5
PUTS
ADD R1,R1,#2
JSR PRINTB
AGAINA
JSR PRINTA

PRINTA
LEA R0, HI_8
PUTS
BR PRINTD

PRINTB
LEA R0,HI_7
PUTS
BR PRINTC

PRINTC
LEA R6,WORDARRAY
LD R2,COUNTER
VP1
LDR R0,R6,#0
PUTC
ADD R6,R6,#2
ADD R2,R2,#-1
BRp VP1
ADD R1,R1,#-1
BRz OK
BR AGAINA

PRINTD
LEA R6,WORDARRAY
LD R2,COUNTER
ADD R6,R6,#1
VP2
LDR R0,R6,#0
PUTC
ADD R6,R6,#2
ADD R2,R2,#-1
BRp VP2
ADD R1,R1,#-1
BRz OK
BR AGAINA

FINALE
LEA R0,HI_5
PUTS
AND R1,R1,#0
ADD R1,R1,#2
JSR PRINTEA
AGAINB
JSR PRINTEB

PRINTEA
LEA R0,HI_7
PUTS
BR PRINTED

PRINTEB
LEA R0,HI_8
PUTS
BR PRINTEC

PRINTEC
LEA R6,WORDARRAY
LD R3,COUNTER
VP3
LDR R0,R6,#0
PUTC
ADD R6,R6,#2
ADD R3,R3,#-1
BRp VP3
ADD R1,R1,#-1
BRz OK
BR AGAINB

PRINTED
LEA R6,WORDARRAY
LD R3,COUNTER
VP4
LDR R0,R6,#0
PUTC
ADD R6,R6,#2
ADD R3,R3,#-1
BRp VP4
ADD R1,R1,#-1
BRz OK
BR AGAINB

LOADARRAY
LEA R6,WORDARRAY
RET

OK
JSR AGAIN

RESETREGISTER
AND R0,R0,#0
AND R1,R1,#0
AND R2,R2,#0
AND R3,R3,#0
AND R4,R4,#0
AND R5,R5,#0
AND R6,R6,#0

CHECKFLAG
LD R6,FLAG
RET

STOP2
LEA R0,HI_9
PUTS
HALT



HI_6 .STRINGZ "Here is your string and the decrypted result:"
HI_7 .STRINGZ "\n<Encrypted>:"
HI_8 .STRINGZ "\n<Descrypted>:"
HI_9 .STRINGZ "\nBye.Have a nice day."
WORDARRAY .BLKW 400

.END